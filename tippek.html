<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VSPORT â€“ AI TeljesÃ­tmÃ©ny TÃ¡bla</title>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { background: #0a0a0a; color: #fff; font-family: 'Segoe UI', sans-serif; min-height: 100vh; }

    header {
      background: #111; border-bottom: 2px solid #222;
      padding: 0 20px; height: 44px;
      display: flex; align-items: center; gap: 10px;
      position: sticky; top: 0; z-index: 100;
    }
    .dot { width: 9px; height: 9px; border-radius: 50%; background: #fff; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.25} }
    header h1 { font-size:.85rem; font-weight:600; letter-spacing:3px; text-transform:uppercase; color:#ddd; }
    .back-btn {
      display: flex; align-items: center; gap: 5px;
      color: #888; font-size: .75rem; text-decoration: none;
      padding: 5px 10px; border: 1px solid #222; border-radius: 4px;
      transition: all .15s;
    }
    .back-btn:hover { color: #fff; border-color: #444; }
    .header-sep { width: 1px; height: 18px; background: #222; margin: 0 5px; }

    .page { max-width: 900px; margin: 0 auto; padding: 20px 16px 40px; }

    .tabs {
      display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid #222;
      padding-bottom: 10px;
    }
    .tab {
      background: none; border: none; color: #666; font-size: .8rem;
      padding: 5px 15px; cursor: pointer; transition: all .15s;
      text-transform: uppercase; letter-spacing: 1px;
    }
    .tab:hover { color: #aaa; }
    .tab.active {
      color: #4caf50; border-bottom: 2px solid #4caf50; position: relative; top: 2px;
    }

    .ai-badge {
      background: #1e6b1e; color: #fff; font-size: .6rem;
      padding: 2px 8px; border-radius: 3px; margin-left: 10px;
      animation: pulse 2s infinite;
    }

    .leaderboard-block { background:#111; border:1px solid #2a2a2a; border-radius:4px; overflow:hidden; margin-bottom: 20px; }
    .leaderboard-header-bar {
      background:#1e6b1e;
      display:grid;
      grid-template-columns: 26px 16px 1fr 80px 46px 36px;
      align-items:center; padding:7px 10px; gap:4px;
    }
    .leaderboard-header-bar span { font-size:.58rem; font-weight:700; color:#fff; text-transform:uppercase; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .leaderboard-header-bar .h-right { text-align:right; }

    .lb-meta {
      background:#0f0f0f; border-bottom:1px solid #1e1e1e;
      padding:4px 10px; font-size:.6rem; color:#444;
      display:flex; justify-content:space-between; align-items:center;
    }
    .refresh-dot { width:5px; height:5px; border-radius:50%; background:#3d8b3d; display:inline-block; margin-right:4px; animation:pulse 2s infinite; }
    .lb-meta.loading .refresh-dot { background:#f59e0b; }
    .lb-meta.error   .refresh-dot { background:#e53935; }

    .leaderboard-body { background:#141414; }

    .lb-row {
      display:grid;
      grid-template-columns: 26px 16px 1fr 80px 46px 36px;
      align-items:center; padding:4px 10px; gap:4px;
      border-bottom:1px solid #1d1d1d; transition:background .12s;
    }
    .lb-row:last-child { border-bottom:none; }
    .lb-row:hover { background:#1c1c1c; }
    .lb-row.top3 { background:#162316; }
    .lb-row.top3:hover { background:#1c2b1c; }
    .lb-row.relegation { background:#1a1010; }
    .lb-row.relegation:hover { background:#231414; }

    .col-pos { font-size:.7rem; font-weight:700; color:#666; text-align:center; }
    .lb-row.top3 .col-pos { color:#4caf50; }
    .lb-row.relegation .col-pos { color:#e53935; }

    .col-trend { display:flex; align-items:center; justify-content:center; }
    .trend-up   { color:#4caf50; font-size:.55rem; }
    .trend-down { color:#e53935; font-size:.55rem; }
    .trend-same { color:#333;    font-size:.55rem; }

    .col-team { display:flex; align-items:center; gap:6px; }
    .team-logo { width:16px; height:16px; object-fit:contain; flex-shrink:0; }
    .team-logo-placeholder { width:16px; height:16px; flex-shrink:0; background:#1a1a1a; border-radius:50%; }
    .team-name { font-size:.76rem; font-weight:600; color:#ccc; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    .col-goals { font-size:.68rem; color:#666; text-align:right; font-variant-numeric:tabular-nums; }
    .col-gd { font-size:.65rem; color:#555; text-align:right; font-variant-numeric:tabular-nums; }
    .col-pts { font-size:.8rem; font-weight:800; color:#fff; text-align:right; font-variant-numeric:tabular-nums; }

    .aipanel {
      background: #111; border: 1px solid #2a2a2a; border-radius: 4px;
      overflow: hidden; margin-top: 20px;
    }
    .aipanel.show { display: block; }
    .aipanel-hdr {
      background: #1a1a1a; border-bottom: 1px solid #2a2a2a;
      padding: 10px 16px; display: flex; align-items: center; gap: 10px;
    }
    .aipanel-title {
      font-size: .8rem; font-weight: 600; letter-spacing: 1px;
      text-transform: uppercase; color: #ddd;
    }
    .aibody {
      padding: 16px 20px; font-size: .82rem; line-height: 1.7;
      color: #ccc; min-height: 100px;
    }

    .dots { display: flex; gap: 5px; padding: 10px 0; justify-content: center; }
    .dots span {
      width: 6px; height: 6px; border-radius: 50%; background: #4caf50;
      opacity: .4; animation: d 1s infinite;
    }
    .dots span:nth-child(2){ animation-delay:.2s; }
    .dots span:nth-child(3){ animation-delay:.4s; }
    @keyframes d { 0%,100%{opacity:.4} 50%{opacity:1} }

    .error-box {
      background: rgba(229, 57, 53, 0.1); border: 1px solid rgba(229, 57, 53, 0.2);
      border-radius: 4px; padding: 12px 16px; font-size: .78rem;
      color: #ff8a80; margin-bottom: 16px; display: none;
    }
    .error-box.show { display: block; }

    .btn {
      background: #1a1a1a; border: 1px solid #333; color: #aaa;
      font-size: .7rem; padding: 5px 12px; border-radius: 4px;
      cursor: pointer; transition: all .15s;
    }
    .btn:hover { background: #242424; border-color: #555; color: #fff; }
  </style>
</head>
<body>

<header>
  <a class="back-btn" href="/">â† Vissza</a>
  <div class="header-sep"></div>
  <div class="dot"></div>
  <h1>VSPORT &mdash; AI TeljesÃ­tmÃ©ny TÃ¡bla</h1>
</header>

<div class="page">
  <div class="tabs">
    <button class="tab active" id="realTab" onclick="showRealTable()">ğŸ“Š ValÃ³di tabella</button>
    <button class="tab" id="aiTab" onclick="showAITable()">ğŸ¤– AI elemzett tabella</button>
  </div>

  <!-- VALÃ“DI TÃBLÃZAT -->
  <div id="realTableContainer">
    <div class="form-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px">
      <div class="title-section">
        <h2>âš¡ Premier Liga - Ã‰lÅ‘ tabella</h2>
      </div>
      <button class="btn" id="refreshRealBtn">ğŸ”„ FrissÃ­tÃ©s</button>
    </div>

    <div class="leaderboard-block">
      <div class="leaderboard-header-bar">
        <span>#</span>
        <span></span>
        <span>Csapat</span>
        <span class="h-right">LÅ‘ttâ€“Kapott</span>
        <span class="h-right">KÃ¼lÃ¶nb.</span>
        <span class="h-right">Pont</span>
      </div>
      <div class="lb-meta loading" id="realMeta">
        <span><span class="refresh-dot"></span>Adatok betÃ¶ltÃ©se...</span>
        <span id="realUpdateTime">â€“</span>
      </div>
      <div class="leaderboard-body" id="realTable">
        <div style="padding:20px; text-align:center; color:#555">BetÃ¶ltÃ©s...</div>
      </div>
    </div>
  </div>

  <!-- AI TÃBLÃZAT -->
  <div id="aiTableContainer" style="display: none;">
    <div class="form-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px">
      <div class="title-section">
        <h2>ğŸ¤– AI becsÃ¼lt tabella <span class="ai-badge">AI</span></h2>
      </div>
      <button class="btn" id="generateAIBtn">âœ¨ AI generÃ¡lÃ¡s</button>
    </div>

    <div class="leaderboard-block">
      <div class="leaderboard-header-bar">
        <span>#</span>
        <span></span>
        <span>Csapat</span>
        <span class="h-right">LÅ‘ttâ€“Kapott</span>
        <span class="h-right">KÃ¼lÃ¶nb.</span>
        <span class="h-right">Pont</span>
      </div>
      <div class="lb-meta" id="aiMeta">
        <span><span class="refresh-dot"></span>AI becslÃ©s</span>
        <span id="aiUpdateTime">â€“</span>
      </div>
      <div class="leaderboard-body" id="aiTable">
        <div style="padding:30px; text-align:center; color:#555">
          Kattints az "AI generÃ¡lÃ¡s" gombra<br>
          <span style="font-size:.6rem; color:#333">A Gemini elemzi a valÃ³s adatokat Ã©s kÃ©szÃ­t egy becslÃ©st</span>
        </div>
      </div>
    </div>

    <div class="aipanel" id="aiPanel" style="display:none;">
      <div class="aipanel-hdr">
        <span class="aipanel-title">ğŸ“Š AI ElemzÃ©s</span>
        <span class="ai-badge">puter.ai / gpt-4o</span>
      </div>
      <div class="aibody" id="aiBody"></div>
    </div>
  </div>

  <div class="error-box" id="errorBox"></div>
</div>

<script src="https://js.puter.com/v2/"></script>
<script>
let realStandings = [];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SEGÃ‰DFÃœGGVÃ‰NYEK
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function gd(gf, ga) {
  const diff = (gf || 0) - (ga || 0);
  if (diff > 0) return `<span style="color:#4caf50">+${diff}</span>`;
  if (diff < 0) return `<span style="color:#e53935">${diff}</span>`;
  return `<span style="color:#555">0</span>`;
}

function trendHtml(t) {
  if (t === 'up') return '<span class="trend-up">â–²</span>';
  if (t === 'down') return '<span class="trend-down">â–¼</span>';
  return '<span class="trend-same">â€”</span>';
}

function logoHtml(logo) {
  if (!logo) return '<span class="team-logo-placeholder"></span>';
  return `<img class="team-logo" src="${logo}" alt="" loading="lazy" onerror="this.style.display='none'">`;
}

function rowClass(pos, total) {
  if (pos <= 3) return 'lb-row top3';
  if (total && pos > total - 3) return 'lb-row relegation';
  return 'lb-row';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ROBUSZTUS JSON PARSER - csonkÃ­tott vÃ¡laszokat is kezel
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function extractJSONArray(text) {
  // 1. LecsupaszÃ­tÃ¡s: markdown blokkok eltÃ¡volÃ­tÃ¡sa
  let s = text.replace(/```json\s*/gi, '').replace(/```\s*/g, '').trim();

  // 2. TÃ¶mb elejÃ©nek megkeresÃ©se
  const start = s.indexOf('[');
  if (start === -1) throw new Error('Nem talÃ¡lhatÃ³ JSON tÃ¶mb a vÃ¡laszban');
  s = s.slice(start);

  // 3. Teljes parse prÃ³ba
  try { return JSON.parse(s); } catch (_) {}

  // 4. Ha csonkÃ­tott: zÃ¡rjuk le az utolsÃ³ Ã©rvÃ©nyes objektumot
  // KeressÃ¼k az utolsÃ³ teljes, jÃ³l lezÃ¡rt objektumot
  const objects = [];
  let depth = 0, inStr = false, escape = false, objStart = -1;

  for (let i = 0; i < s.length; i++) {
    const c = s[i];
    if (escape) { escape = false; continue; }
    if (c === '\\' && inStr) { escape = true; continue; }
    if (c === '"') { inStr = !inStr; continue; }
    if (inStr) continue;

    if (c === '{') {
      if (depth === 0) objStart = i;
      depth++;
    } else if (c === '}') {
      depth--;
      if (depth === 0 && objStart !== -1) {
        try {
          objects.push(JSON.parse(s.slice(objStart, i + 1)));
        } catch (_) {}
        objStart = -1;
      }
    }
  }

  if (objects.length > 0) {
    console.warn(`CsonkÃ­tott vÃ¡lasz â€“ csak ${objects.length} objektum nyerhetÅ‘ ki`);
    return objects;
  }

  throw new Error('Nem sikerÃ¼lt Ã©rvÃ©nyes adatokat kinyerni a vÃ¡laszbÃ³l');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// VALÃ“DI TABELLA
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function fetchRealStandings() {
  const response = await fetch('/api/standings?liga=pl');
  if (!response.ok) throw new Error(`API hiba: ${response.status}`);
  const data = await response.json();
  return data.standings || [];
}

function renderRealTable(standings) {
  const table = document.getElementById('realTable');
  const meta = document.getElementById('realMeta');
  const updateTime = document.getElementById('realUpdateTime');

  if (!standings || standings.length === 0) {
    table.innerHTML = '<div style="padding:20px; text-align:center; color:#555">Nincs adat</div>';
    return;
  }

  const total = standings.length;
  table.innerHTML = standings.map(r => `
    <div class="${rowClass(r.pos, total)}">
      <span class="col-pos">${r.pos}</span>
      <span class="col-trend">${trendHtml(r.trend ?? 'same')}</span>
      <span class="col-team">${logoHtml(r.logo)}<span class="team-name">${r.team}</span></span>
      <span class="col-goals">${r.goalsFor ?? 'â€“'}:${r.goalsAgainst ?? 'â€“'}</span>
      <span class="col-gd">${gd(r.goalsFor, r.goalsAgainst)}</span>
      <span class="col-pts">${r.pts}</span>
    </div>
  `).join('');

  meta.className = 'lb-meta';
  meta.querySelector('span:first-child').innerHTML = '<span class="refresh-dot"></span>Ã‰lÅ‘ adatok';
  updateTime.textContent = new Date().toLocaleTimeString('hu-HU');
}

async function loadRealTable() {
  const meta = document.getElementById('realMeta');
  meta.className = 'lb-meta loading';
  meta.querySelector('span:first-child').innerHTML = '<span class="refresh-dot"></span>BetÃ¶ltÃ©s...';

  try {
    realStandings = await fetchRealStandings();
    renderRealTable(realStandings);
  } catch(e) {
    showError(e.message);
    meta.className = 'lb-meta error';
    meta.querySelector('span:first-child').innerHTML = '<span class="refresh-dot"></span>Hiba';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// AI TABELLA GENERÃLÃSA
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function generateAITable() {
  const meta = document.getElementById('aiMeta');
  const aiTable = document.getElementById('aiTable');
  const aiPanel = document.getElementById('aiPanel');
  const updateTime = document.getElementById('aiUpdateTime');

  meta.className = 'lb-meta loading';
  meta.querySelector('span:first-child').innerHTML = '<span class="refresh-dot"></span>AI generÃ¡lÃ¡s...';
  aiTable.innerHTML = '<div class="dots"><span></span><span></span><span></span></div>';
  aiPanel.style.display = 'none';
  hideError();

  if (realStandings.length === 0) {
    try { realStandings = await fetchRealStandings(); }
    catch(e) { showError(`Nem sikerÃ¼lt betÃ¶lteni a valÃ³di adatokat: ${e.message}`); meta.className = 'lb-meta error'; return; }
  }

  if (realStandings.length === 0) {
    showError('Nincs adat az elemzÃ©shez');
    meta.className = 'lb-meta error';
    return;
  }

  const teamCount = realStandings.length;
  const allTeamsData = realStandings.map(t =>
    `${t.pos}. ${t.team}: ${t.pts}pt ${t.goalsFor||0}:${t.goalsAgainst||0}`
  ).join('\n');

  // ErÅ‘s elemzÃ©si prompt â€“ az AI-t valÃ³di sajÃ¡t elÅ‘rejelzÃ©sre kÃ©nyszerÃ­t
  const prompt = `Te egy virtuÃ¡lis futball liga profÃ­ elemzÅ‘je vagy. A jelenlegi tabella alapjÃ¡n kÃ©szÃ­ts SAJÃT, FÃœGGETLEN elÅ‘rejelzÃ©st a szezon vÃ©gÃ©re!

JELENLEGI TABELLA:
${allTeamsData}

SZABÃLYOK â€“ KÃ–TELEZÅ BETARTANI:
1. A sorrend VÃLTOZZON JELENTÅSEN â€“ legalÃ¡bb 5 csapat kerÃ¼ljÃ¶n mÃ¡s helyre mint jelenleg!
2. A pontok Ã©s gÃ³lok KÃœLÃ–NBÃ–ZZENEK â€“ becsld meg a szezon vÃ©gÃ©re valÃ³ Ã©rtÃ©keket!
3. NÃ©hÃ¡ny meglepÅ‘: egy jelenlegi kÃ¶zÃ©pcsapat kerÃ¼ljÃ¶n fel, egy top csapat essen vissza!
4. trend: "up" ha feljebb kerÃ¼l a jelenleginÃ©l, "down" ha lejjebb, "same" ha marad
5. TILOS a valÃ³s tabella egyszerÅ± lemÃ¡solÃ¡sa!

VÃ¡laszolj KIZÃRÃ“LAG kompakt JSON tÃ¶mbbel (egy sorban), semmi mÃ¡s szÃ¶veg:
[{"pos":1,"team":"Cs.NÃ©v","goalsFor":72,"goalsAgainst":28,"pts":87,"trend":"up"},{"pos":2,...}]`;

  try {
    const text = await puter.ai.chat(prompt, {
      model: 'gpt-4o',
      temperature: 0.9
    });

    console.log('Puter AI nyers vÃ¡lasz:', text);

    // Robusztus JSON kinyerÃ©s
    const aiStandings = extractJSONArray(typeof text === 'string' ? text : text?.message?.content || JSON.stringify(text));

    if (!aiStandings || aiStandings.length === 0) {
      throw new Error('Ãœres tabella Ã©rkezett az AI-tÃ³l');
    }

    console.log(`Sikeresen feldolgozva: ${aiStandings.length} csapat`);

    renderAITable(aiStandings);
    await generateAnalysis(aiStandings);

    meta.className = 'lb-meta';
    meta.querySelector('span:first-child').innerHTML = '<span class="refresh-dot"></span>AI becslÃ©s';
    updateTime.textContent = new Date().toLocaleTimeString('hu-HU');

  } catch(e) {
    console.error('GenerÃ¡lÃ¡si hiba:', e);
    showError(`âš ï¸ ${e.message}`);
    meta.className = 'lb-meta error';
    meta.querySelector('span:first-child').innerHTML = '<span class="refresh-dot"></span>Hiba';
    aiTable.innerHTML = '<div style="padding:30px; text-align:center; color:#555">Hiba tÃ¶rtÃ©nt. PrÃ³bÃ¡ld Ãºjra.</div>';
  }
}

function renderAITable(standings) {
  const table = document.getElementById('aiTable');
  if (!standings || standings.length === 0) {
    table.innerHTML = '<div style="padding:20px; text-align:center; color:#555">Nincs AI adat</div>';
    return;
  }
  const total = standings.length;
  table.innerHTML = standings.map(r => `
    <div class="${rowClass(r.pos, total)}">
      <span class="col-pos">${r.pos}</span>
      <span class="col-trend">${trendHtml(r.trend)}</span>
      <span class="col-team">
        <span class="team-logo-placeholder"></span>
        <span class="team-name">${r.team}</span>
      </span>
      <span class="col-goals">${r.goalsFor}:${r.goalsAgainst}</span>
      <span class="col-gd">${gd(r.goalsFor, r.goalsAgainst)}</span>
      <span class="col-pts">${r.pts}</span>
    </div>
  `).join('');
}

async function generateAnalysis(standings) {
  const aiPanel = document.getElementById('aiPanel');
  const aiBody = document.getElementById('aiBody');

  const top3 = standings.slice(0, 3).map(t => `${t.pos}. ${t.team} (${t.pts} pont)`).join(', ');
  const bot3 = standings.slice(-3).map(t => `${t.pos}. ${t.team} (${t.pts} pont)`).join(', ');

  const prompt = `RÃ¶vid elemzÃ©s MAGYARUL (max 4 mondat):
Top 3: ${top3}
UtolsÃ³ 3: ${bot3}
MiÃ©rt lehetnek ezek a csapatok ilyen helyzetben a kÃ¶vetkezÅ‘ kÃ¶rÃ¶kben?`;

  try {
    const text = await puter.ai.chat(prompt, { model: 'gpt-4o' });
    const textStr = typeof text === 'string' ? text : text?.message?.content || '';
    if (textStr) {
      aiBody.innerHTML = textStr.replace(/\n/g, '<br>');
      aiPanel.style.display = 'block';
    }
  } catch(e) {
    console.error('ElemzÃ©si hiba:', e);
    aiPanel.style.display = 'none';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SEGÃ‰D: hibakezelÃ©s
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showError(msg) {
  const box = document.getElementById('errorBox');
  box.textContent = msg;
  box.classList.add('show');
}
function hideError() {
  document.getElementById('errorBox').classList.remove('show');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TAB VÃLTÃS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showRealTable() {
  document.getElementById('realTableContainer').style.display = 'block';
  document.getElementById('aiTableContainer').style.display = 'none';
  document.getElementById('realTab').classList.add('active');
  document.getElementById('aiTab').classList.remove('active');
}

function showAITable() {
  document.getElementById('realTableContainer').style.display = 'none';
  document.getElementById('aiTableContainer').style.display = 'block';
  document.getElementById('realTab').classList.remove('active');
  document.getElementById('aiTab').classList.add('active');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INICIALIZÃLÃS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', () => {
  loadRealTable();
  document.getElementById('refreshRealBtn').addEventListener('click', loadRealTable);
  document.getElementById('generateAIBtn').addEventListener('click', generateAITable);
  setInterval(loadRealTable, 30000);
});
</script>

</body>
</html>
